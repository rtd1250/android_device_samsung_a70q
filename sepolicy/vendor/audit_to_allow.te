# whatever audit2allow spit out, to be reviewed, probably insecure.

#============= adbroot ==============
#allow adbroot same_process_hal_file:file { getattr read };

#============= apexd ==============
allow apexd same_process_hal_file:file { getattr read };

#============= auditctl ==============
#allow auditctl same_process_hal_file:file { getattr read };

#============= blkid_untrusted ==============
allow blkid_untrusted same_process_hal_file:file { getattr read };

#============= bluetooth ==============
allow bluetooth unlabeled:file read;

#============= bootstat ==============
allow bootstat same_process_hal_file:file { getattr read };

#============= boringssl_self_test ==============
#allow boringssl_self_test same_process_hal_file:file { getattr read };

#============= bpfloader ==============
#allow bpfloader same_process_hal_file:file { getattr read };

#============= credstore ==============
allow credstore same_process_hal_file:file { getattr read };

#============= derive_classpath ==============
#allow derive_classpath same_process_hal_file:file { getattr read };

#============= derive_sdk ==============
#allow derive_sdk same_process_hal_file:file { getattr read };

#============= dex2oat ==============
#allow dex2oat same_process_hal_file:file { getattr read };

#============= drmserver ==============
allow drmserver same_process_hal_file:file { getattr read };

#============= flags_health_check ==============
allow flags_health_check same_process_hal_file:file { getattr read };

#============= fsck ==============
allow fsck same_process_hal_file:file { getattr read };
allow fsck self:capability kill;

#============= fsverity_init ==============
#allow fsverity_init same_process_hal_file:file { getattr read };

#============= gatekeeperd ==============
allow gatekeeperd same_process_hal_file:file { getattr read };

#============= gsid ==============
#allow gsid same_process_hal_file:file { getattr read };

#============= hal_allocator_default ==============
#allow hal_allocator_default same_process_hal_file:file { getattr read };

#============= hal_audio_default ==============
allow hal_audio_default radio_prop:file { getattr map open read };

#============= hal_bluetooth_default ==============
#allow hal_bluetooth_default debug_level_prop:file { getattr map open read };
#allow hal_bluetooth_default vendor_factory_prop:file { getattr map open read };

#============= hal_camera_default ==============
allow hal_camera_default aac_drc_prop:file { getattr map open };
allow hal_camera_default ab_update_gki_prop:file { getattr map open };
allow hal_camera_default adbd_config_prop:file { getattr map open };
#allow hal_camera_default adbd_prop:file { getattr map open };
allow hal_camera_default apexd_config_prop:file { getattr map open };
allow hal_camera_default apexd_prop:file { getattr map open };
allow hal_camera_default apk_verity_prop:file { getattr map open };
allow hal_camera_default audio_config_prop:file { getattr map open };
allow hal_camera_default audio_prop:file { getattr map open };
allow hal_camera_default bluetooth_a2dp_offload_prop:file { getattr map open };
allow hal_camera_default bluetooth_audio_hal_prop:file { getattr map open };
allow hal_camera_default bluetooth_prop:file { getattr map open };
#allow hal_camera_default boot_force_upload_prop:file { getattr map open };
allow hal_camera_default boot_status_prop:file { getattr map open };
allow hal_camera_default bootanim_config_prop:file { getattr map open };
allow hal_camera_default bootanim_system_prop:file { getattr map open };
allow hal_camera_default bootloader_boot_reason_prop:file { getattr map open };
allow hal_camera_default boottime_prop:file { getattr map open };
allow hal_camera_default boottime_public_prop:file { getattr map open };
allow hal_camera_default bpf_progs_loaded_prop:file { getattr map open };
allow hal_camera_default build_bootimage_prop:file { getattr map open };
allow hal_camera_default build_config_prop:file { getattr map open };
allow hal_camera_default camera2_extensions_prop:file { getattr map open };
allow hal_camera_default camera_calibration_prop:file { getattr map open };
allow hal_camera_default camera_config_prop:file { getattr map open };
allow hal_camera_default camerax_extensions_prop:file { getattr map open };
allow hal_camera_default charger_config_prop:file { getattr map open };
allow hal_camera_default charger_prop:file { getattr map open };
allow hal_camera_default charger_status_prop:file { getattr map open };
allow hal_camera_default codec2_config_prop:file { getattr map open };
allow hal_camera_default cold_boot_done_prop:file { getattr map open };
#allow hal_camera_default compact_dump_prop:file { getattr map open };
allow hal_camera_default config_prop:file { getattr map open };
allow hal_camera_default cppreopt_prop:file { getattr map open };
allow hal_camera_default cpu_variant_prop:file { getattr map open };
allow hal_camera_default ctl_adbd_prop:file open;
#allow hal_camera_default ctl_dpmd_prop:file { getattr map open };
allow hal_camera_default ctl_dumpstate_prop:file { getattr map open };
allow hal_camera_default ctl_fuse_prop:file { getattr map open };
allow hal_camera_default ctl_gsid_prop:file { getattr map open };
#allow hal_camera_default ctl_hbtp_prop:file { getattr map open };
allow hal_camera_default ctl_interface_restart_prop:file { getattr map open };
allow hal_camera_default ctl_interface_start_prop:file { getattr map open };
allow hal_camera_default ctl_interface_stop_prop:file { getattr map open };
allow hal_camera_default ctl_mdnsd_prop:file { getattr map open };
#allow hal_camera_default ctl_mediatranscoding_prop:file { getattr map open };
#allow hal_camera_default ctl_odsign_prop:file { getattr map open };
allow hal_camera_default ctl_restart_prop:file { getattr map open };
allow hal_camera_default ctl_rildaemon_prop:file open;
allow hal_camera_default ctl_sigstop_prop:file { getattr map open };
#allow hal_camera_default ctl_snapuserd_prop:file { getattr map open };
allow hal_camera_default ctl_start_prop:file { getattr map open };
allow hal_camera_default ctl_stop_prop:file { getattr map open };
#allow hal_camera_default ctl_tcmd_prop:file { getattr map open };
allow hal_camera_default dalvik_config_prop:file { getattr map open };
allow hal_camera_default dalvik_prop:file { getattr map open };
allow hal_camera_default dalvik_runtime_prop:file { getattr map open };
allow hal_camera_default dck_prop:file { getattr map open };
allow hal_camera_default debugfs_restriction_prop:file { getattr map open };
allow hal_camera_default debuggerd_prop:file { getattr map open };
allow hal_camera_default default_prop:file { getattr map open };
allow hal_camera_default default_prop:property_service set;
allow hal_camera_default device_config_activity_manager_native_boot_prop:file { getattr map open };
allow hal_camera_default device_config_boot_count_prop:file { getattr map open };
#allow hal_camera_default device_config_configuration_prop:file { getattr map open };
#allow hal_camera_default device_config_connectivity_prop:file { getattr map open };
allow hal_camera_default device_config_input_native_boot_prop:file { getattr map open };
#allow hal_camera_default device_config_lmkd_native_prop:file { getattr map open };
allow hal_camera_default device_config_media_native_prop:file { getattr map open };
allow hal_camera_default device_config_netd_native_prop:file { getattr map open };
#allow hal_camera_default device_config_profcollect_native_boot_prop:file { getattr map open };
allow hal_camera_default device_config_reset_performed_prop:file { getattr map open };
allow hal_camera_default device_config_runtime_native_boot_prop:file { getattr open };
allow hal_camera_default unlabeled:file { getattr map open read };

#============= hal_fingerprint_default ==============
allow hal_fingerprint_default sysfs_tsp:dir search;
allow hal_fingerprint_default sysfs_tsp:file { getattr open write };

#============= hal_health_default ==============
allow hal_health_default app_efs_file:dir { add_name write };
allow hal_health_default app_efs_file:file { create setattr write };

#============= hal_thermal_default ==============
allow hal_thermal_default sysfs:file { getattr open read };
allow hal_thermal_default sysfs_batteryinfo:dir search;
allow hal_thermal_default sysfs_batteryinfo:file { getattr open read };
allow hal_thermal_default sysfs_power:file { open read };
allow hal_thermal_default sysfs_switch:dir search;

#============= hal_usb_default ==============
allow hal_usb_default vendor_sysfs_usb_c:dir { open read search };

#============= hal_wifi_default ==============
allow hal_wifi_default self:capability sys_module;

#============= hwservicemanager ==============
allow hwservicemanager same_process_hal_file:file read;

#============= idmap ==============
allow idmap same_process_hal_file:file { getattr read };

#============= incidentd ==============
allow incidentd same_process_hal_file:file { getattr read };

#============= init ==============
allow init hal_sensors_hwservice:hwservice_manager { add find };
allow init hidl_base_hwservice:hwservice_manager add;
allow init hwservicemanager:binder { call transfer };
allow init same_process_hal_file:file execute;
allow init self:qipcrtr_socket { getattr read setopt write };
allow init sysfs:file { open read setattr };
allow init sysfs_tsp:file open;
allow init sysfs_wake_lock:file { open read write };
allow init system_server:fd use;
allow init vendor_file:file { execute execute_no_trans };
allow init vendor_persist_sensors_file:file append;
allow init vendor_sysfs_sensors:file { open write };
allow init vendor_toolbox_exec:file execute_no_trans;

#============= installd ==============
allow installd same_process_hal_file:file { getattr read };

#============= kernel ==============
allow kernel sysfs:file { open read };

#============= keystore ==============
allow keystore same_process_hal_file:file { getattr read };

#============= linkerconfig ==============
#allow linkerconfig self:capability kill;

#============= lmkd ==============
allow lmkd same_process_hal_file:file { getattr read };

#============= logd ==============
allow logd same_process_hal_file:file { getattr read };

#============= macloader ==============
allow macloader init:unix_stream_socket connectto;
allow macloader property_socket:sock_file write;
allow macloader vendor_default_prop:property_service set;

#============= mediacodec ==============
allow mediacodec vendor_hal_perf_default:binder call;
allow mediacodec vendor_hal_perf_hwservice:hwservice_manager find;

#============= mediametrics ==============
allow mediametrics same_process_hal_file:file { getattr read };

#============= mediaprovider ==============
allow mediaprovider unlabeled:file read;

#============= netd ==============
allow netd same_process_hal_file:file { getattr read };

#============= network_stack ==============
allow network_stack unlabeled:file read;

#============= odrefresh ==============
#allow odrefresh same_process_hal_file:file { getattr read };
#allow odrefresh self:capability kill;

#============= odsign ==============
#allow odsign same_process_hal_file:file { getattr read };

#============= permissioncontroller_app ==============
#allow permissioncontroller_app unlabeled:file read;

#============= platform_app ==============
allow platform_app unlabeled:file read;

#============= priv_app ==============
allow priv_app unlabeled:file read;

#============= radio ==============
allow radio unlabeled:file read;

#============= recovery_persist ==============
allow recovery_persist same_process_hal_file:file { getattr read };

#============= rild ==============
allow rild default_prop:file { getattr map open read };
allow rild vendor_radio_data_file:dir { add_name open read remove_name write };
allow rild vendor_radio_data_file:file { create getattr ioctl lock open read unlink write };

#============= secure_element ==============
allow secure_element unlabeled:file read;

#============= servicemanager ==============
allow servicemanager same_process_hal_file:file { getattr read };

#============= shared_relro ==============
allow shared_relro unlabeled:file read;

#============= statsd ==============
allow statsd same_process_hal_file:file { getattr read };

#============= storaged ==============
#allow storaged same_process_hal_file:file { getattr read };

#============= system_app ==============
allow system_app unlabeled:file read;

#============= system_server ==============
allow system_server init:binder { call transfer };

#============= system_server_startup ==============
#allow system_server_startup unlabeled:file read;

#============= system_suspend ==============
#allow system_suspend same_process_hal_file:file { getattr read };
#allow system_suspend sysfs:dir { open read };
#allow system_suspend sysfs:file { getattr open read };
#allow system_suspend sysfs_batteryinfo:dir { open read };
#allow system_suspend sysfs_batteryinfo:file { getattr open read };
#allow system_suspend sysfs_rtc:dir { open read };
#allow system_suspend sysfs_rtc:file { getattr open read };

#============= tombstoned ==============
allow tombstoned same_process_hal_file:file { getattr read };

#============= toolbox ==============
allow toolbox same_process_hal_file:file { getattr read };

#============= traced ==============
allow traced same_process_hal_file:file { getattr read };

#============= traced_probes ==============
allow traced_probes same_process_hal_file:file { getattr read };

#============= tzdatacheck ==============
allow tzdatacheck same_process_hal_file:file { getattr read };

#============= untrusted_app ==============
allow untrusted_app unlabeled:file read;

#============= usbd ==============
allow usbd same_process_hal_file:file { getattr read };

#============= vdc ==============
allow vdc same_process_hal_file:file { getattr read };

#============= vendor_hvdcp ==============
allow vendor_hvdcp sysfs:file { open read };

#============= vendor_init ==============
allow vendor_init build_prop:property_service set;
allow vendor_init default_prop:file read;
allow vendor_init hwservicemanager_prop:file read;
#allow vendor_init init_service_status_private_prop:file read;
allow vendor_init persist_debug_prop:file read;
allow vendor_init system_data_file:dir { create ioctl open read setattr };
allow vendor_init tombstone_data_file:dir { getattr ioctl open read };

#============= vendor_qti_init_shell ==============
allow vendor_qti_init_shell system_prop:file { getattr map open read };
allow vendor_qti_init_shell system_prop:property_service set;
allow vendor_qti_init_shell usb_control_prop:file { getattr map open read };
allow vendor_qti_init_shell usb_control_prop:property_service set;

#============= vendor_thermal-engine ==============
allow vendor_thermal-engine sysfs_batteryinfo:dir search;

#============= vendor_time_daemon ==============
allow vendor_time_daemon self:capability { dac_override dac_read_search };

#============= vold ==============
allow vold same_process_hal_file:file { getattr read };

#============= vold_prepare_subdirs ==============
allow vold_prepare_subdirs same_process_hal_file:file { getattr read };

#============= webview_zygote ==============
allow webview_zygote unlabeled:file read;

#============= wificond ==============
allow wificond same_process_hal_file:file { getattr read };

#============= zygote ==============
allow zygote bluetooth_prop:file { getattr map open read };